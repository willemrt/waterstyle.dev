(function(e){define(["text!scripts/redactor/ueditor-templates.html"],function(t){var n=Upfront.mainData.l10n.global.ueditor,r=_([{vid:"center",label:"Center"},{vid:"left",label:"Left"},{vid:"right",label:"Right"}]),i=Backbone.View.extend({tpl:_.template(e(t).find("#image-style-tpl").html()),initialize:function(e){this.data=new Backbone.Model,this.listenTo(this.data,"change",this.render),this.data.set("variants",r.toArray()),this.data.set("selected",e.get("variant_id")?e.get("variant_id"):"center")},events:{"change input[type=radio]":"update_data","click input[type=radio]":"on_click"},render:function(){return this.$el.html(this.tpl({data:this.data.toJSON()})),this},on_click:function(e){e.stopPropagation()},update_data:function(t){t.stopPropagation(),this.variant_id=e(t.target).val(),this._style=r.findWhere({vid:this.variant_id})}}),s=Backbone.View.extend({tpl:_.template(e(t).find("#image-link-tpl").html()),initialize:function(e){e.data&&(this.model=new Backbone.Model(e.data),this.listenTo(this.model,"change",this.render))},events:{"change input[type=radio]":"updateData"},render:function(){this.$el.width("200px");var e=this.model.toJSON();e.checked='checked="checked"',this.$el.html(this.tpl(e))},updateData:function(e){var t=this,n=this.$("input:checked").val(),r=this.$("#uinsert-image-link-url").val();if(n=="post"){var i={postTypes:this.postTypes()};Upfront.Views.Editor.PostSelector.open(i).done(function(e){t.model.set({linkType:"post",linkUrl:e.get("permalink")})})}else this.model.set({linkType:n,linkUrl:r})},postTypes:function(){var e=[];return _.each(Upfront.data.ugallery.postTypes,function(t){t.name!="attachment"&&e.push({name:t.name,label:t.label})}),e}}),o=Backbone.View.extend({initialize:function(e){this.data=new Backbone.Model,this.data.set("variants",Upfront.Content.ImageVariants.toJSON()),this.data.set("selected",e.get("variant_id"))},events:{},prepare_values:function(){var e=this,t=[];return _.each(this.data.get("variants"),function(e,n){t.push({value:e.vid,label:e.label})}),t},get_default_value:function(){return this.data.get("selected")},render:function(){var e=this,t=new Upfront.Views.Editor.Field.Select({className:"upfront-field-wrap upfront-field-wrap-image-style-variant",label:n.choose_image_insert,name:"uf_image_style_variants",default_value:this.get_default_value(),multiple:!1,values:this.prepare_values(),change:function(t){e._style=Upfront.Content.ImageVariants.findWhere({vid:t}),e.data.set("selected",t)}});return t.render(),this.$el.html(t.$el),this},on_click:function(e){e.stopPropagation()}}),u=Backbone.View.extend({className:"upfront-wp-image-style-variants",tpl:_.template(e(t).find("#wp-image-style-tpl").html()),events:{"click .upfront-icon-wp-image-style":"update_data"},get_alignments:function(){return[{id:"alignleft",label:n.align_left,icon:"upfront-icon-wp-image-style-alignleft"},{id:"aligncenter",label:n.align_center,icon:"upfront-icon-wp-image-style-aligncenter"},{id:"alignright",label:n.align_right,icon:"upfront-icon-wp-image-style-alignright"},{id:"alignnone",label:n.align_none,icon:"upfront-icon-wp-image-style-alignnone"}]},initialize:function(e){this.data=new Backbone.Model,this.data.set("variants",this.get_alignments()),this.listenTo(this.data,"change",this.render),this.data.set("selected",this.model.get("variant_id")||this.model.get("style").wrapper.alignment)},get_default_value:function(){return this.data.get("selected")},render:function(){return this.$el.html(this.tpl({data:this.data.toJSON()})),this},on_click:function(e){e.stopPropagation()},update_data:function(t){t.preventDefault();var n=e(t.target),r=n.data("id");this.data.set("selected",r),this.model.set("variant_id",r)}});return{LinkView:s,ImageStylesView:i,PostImageStylesView:o,WP_PostImageStylesView:u,BasicImageVariants:r}})})(jQuery);