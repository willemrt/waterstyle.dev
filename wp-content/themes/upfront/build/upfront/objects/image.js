(function(e){define([],function(){var t=Upfront.Models.ObjectModel.extend({init:function(){this.init_property("type","ImageModel"),this.init_property("view_class","ImageView"),this.init_property("element_id",Upfront.Util.get_unique_id("image-object")),this.init_property("class","c24"),this.init_property("has_settings",1)}}),n=Upfront.Views.ObjectView.extend(_.extend({},{model:t,get_buttons:function(){return'<a href="#" class="upfront-icon-button upfront-icon-button-crop"></a>'},get_content_markup:function(){var e=this;require(["text!upfront/templates/objects/image/image.html"],function(t){var n={src:e.model.get_content(),image_title:e.model.get_property_value_by_name("image_title"),alternative_text:e.model.get_property_value_by_name("alternative_text"),when_clicked:e.model.get_property_value_by_name("when_clicked"),image_link:e.model.get_property_value_by_name("image_link"),include_image_caption:e.model.get_property_value_by_name("include_image_caption"),image_caption:e.model.get_property_value_by_name("image_caption"),caption_position:e.model.get_property_value_by_name("caption_position"),caption_alignment:e.model.get_property_value_by_name("caption_alignment"),caption_trigger:e.model.get_property_value_by_name("caption_trigger")},r="";r=_.template(t,n),e.$el.find(".upfront-object-content").html(r)})}})),r=Upfront.Views.Editor.Sidebar.Element.extend({draggable:!1,render:function(){this.$el.addClass("upfront-icon-element upfront-icon-element-image"),this.$el.html("Image (old)")},add_element:function(){var e=new t({name:"",properties:[{name:"content",value:"http://wpsalad.com/wp-content/uploads/2012/11/wpmudev.png"}]}),n=new Upfront.Models.Module({name:"",properties:[{name:"element_id",value:Upfront.Util.get_unique_id("module")},{name:"class",value:"c6 upfront-image_module"},{name:"has_settings",value:0}],objects:[e]});this.add_module(n)}}),i=Upfront.Views.Editor.Settings.Settings.extend({initialize:function(){this.panels=_([new s({model:this.model}),new o({model:this.model})])},get_title:function(){return"Image settings"}}),s=Upfront.Views.Editor.Settings.Panel.extend({initialize:function(){var t=function(){this.settings.invoke("render")};this.settings=_([new a({model:this.model,name:"image_title",label:"Image Title",value:this.model.get_property_value_by_name("image_title")}),new a({model:this.model,name:"alternative_text",label:"Alternative text",value:this.model.get_property_value_by_name("alternative_text")}),new l({model:this.model,name:"include_image_caption",label:"Include image caption",value:this.model.get_property_value_by_name("include_image_caption"),events:{"click #include_image_caption":"do"},"do":function(){var t=this.$el.find("#include_image_caption").is(":checked")?"yes":"no";t=="yes"?(e("#field_image_caption").show(),e("#field_caption_position").show(),e("#field_caption_position").parent().show(),e("#field_caption_trigger").show(),e("#field_caption_alignment").show()):(e("#field_image_caption").hide(),e("#field_caption_position").hide(),e("#field_caption_trigger").hide(),e("#field_caption_alignment").hide())}}),new f({model:this.model,name:"image_caption",label:"Image Caption",value:this.model.get_property_value_by_name("image_caption"),trigger_name:"include_image_caption",trigger_value:"yes"})])},get_label:function(){return"Description"},get_title:function(){return!1}}),o=Upfront.Views.Editor.Settings.Panel.extend({initialize:function(){var t=function(){this.settings.invoke("render")};this.model.on("doit",t,this),this.settings=_([new c({model:this.model,title:"When Clicked",name:"when_clicked",label:"when_clicked",value:this.model.get_property_value_by_name("when_clicked")?this.model.get_property_value_by_name("when_clicked"):!1,options:[{name:"when_clicked",value:"do_nothing",label:"do nothing",icon:"","default":"true"},{name:"when_clicked",value:"open_link",label:"open link",icon:"","default":"false"},{name:"when_clicked",value:"show_larger_image",label:"show larger image",icon:"","default":"false"}],events:{"click input:radio[name=when_clicked]":"do"},"do":function(){var t=this.$el.find("input:radio[name=when_clicked]:checked").val();t=="open_link"?e("#field_image_link").show():e("#field_image_link").hide()}}),new a({model:this.model,name:"image_link",label:"Image link",value:this.model.get_property_value_by_name("image_link")}),new c({model:this.model,name:"caption_position",title:"Caption Settings",label:"caption_position",value:this.model.get_property_value_by_name("caption_position")?this.model.get_property_value_by_name("caption_position"):!1,options:[{name:"caption_position",value:"below_image",label:"below image",icon:'<i class="icon-th-large"></i>',"default":"true"},{name:"caption_position",value:"over_image",label:"over image",icon:'<i class="icon-th-large"></i>'}]}),new c({model:this.model,name:"caption_trigger",label:"caption_trigger",value:this.model.get_property_value_by_name("caption_trigger")?this.model.get_property_value_by_name("caption_trigger"):!1,options:[{name:"caption_trigger",value:"always_show",label:"Always show",icon:'<i class="icon-th-large"></i>',"default":"true"},{name:"caption_trigger",value:"hover_show",label:"Show on hover",icon:'<i class="icon-th-large"></i>',"default":"false"}]}),new c({model:this.model,name:"caption_alignment",label:"caption_alignment",value:this.model.get_property_value_by_name("caption_alignment")?this.model.get_property_value_by_name("caption_alignment"):!1,options:[{name:"caption_alignment",value:"top",label:"Top",icon:'<i class="icon-th-large"></i>',"default":"true"},{name:"caption_alignment",value:"bottom",label:"Bottom",icon:'<i class="icon-th-large"></i>',"default":"false"},{name:"caption_alignment",value:"fill",label:"Fill",icon:'<i class="icon-th-large"></i>',"default":"false"}]})])},get_label:function(){return"Behavior"},get_title:function(){return!1}}),u=Upfront.Views.Editor.Settings.Item.extend({initialize:function(e){this.title=e.title?e.title:!1,this.name=e.name,this.label=e.label?e.label:!1,this.value=e.value,this.icon=e.icon?e.icon:!1,this.type=e.type?e.type:!1,this.options=e.options?e.options:!1,this.events=e.events?e.events:"",this.do=e.do},render:function(){this.$el.empty();if(this.trigger_name&&this.model.get_property_value_by_name(this.trigger_name)!=this.trigger_value)return!1;this.title?this.wrap({title:this.title,markup:this.get_markup()}):this.$el.append('<div class="upfront-settings-item"><div class="'+this.name+'-field">'+this.get_markup()+"</div></div>")},get_name:function(){return this.name},get_value:function(){return this.$el.find('[name="'+this.name+'"]').val()}}),a=u.extend({get_markup:function(){var e=this.model.get_property_value_by_name(this.name)||this.value;e=e||"";var t={label:this.label,name:this.name,value:e},n='<div id="field_{{name}}">{[ if (label) { ]}<label for="{{name}}">{{label}}</label> {[ } ]}<input type="text" name="{{name}}" value="{{value}}" /></div>',r=_.template(n,t);return r}}),f=u.extend({get_markup:function(){var e=this.model.get_property_value_by_name(this.name)||this.value;e=e||"";var t={label:this.label,name:this.name,value:e,icon:this.icon},n='<div id="field_{{name}}">{[ if (label) { ]}<label for="{{name}}">{{label}}</label> {[ } ]}<textarea name="{{name}}">{{value}}</textarea></div>',r=_.template(n,t);return r}}),l=u.extend({get_markup:function(){var e=this.model.get_property_value_by_name(this.name)?this.model.get_property_value_by_name(this.name):"no";e=e||"";var t={label:this.label,name:this.name,value:"yes",checked:e=="yes"?"checked":""},n='<div id="field_{{name}}"><input id="{{name}}" type="checkbox" name="{{name}}" value="1" {{checked}} />{[ if (label) { ]}<label for="{{name}}">{{label}}</label> {[ } ]}</div>',r=_.template(n,t);return r},get_value:function(){var e=this.$el.find('input[name="'+this.name+'"]').is(":checked")?"yes":"no";return e}}),c=u.extend({get_markup:function(){var e=this.model.get_property_value_by_name(this.name),t='<div id="field_'+this.name+'">',n='<input type="radio" name="{{name}}" id="{{name}}" value="{{value}}" {[ if(typeof selected != "undefined" && selected) { ]} checked  {[ } ]}> <span class="radio-button-label">{{icon}} {[ if (label) { ]}<label for="{{name}}">{{label}}</label> {[ } ]}</span>';return _.each(this.options,function(r){!this.value&&r.default=="true"?r.selected=!0:e==r.value&&(r.selected=!0),t+=_.template(n,r)}),t+="</div>",t},get_name:function(){return this.name},get_value:function(){var e=this.$el.find("input:radio[name="+this.name+"]:checked").val();return e!=""?e:""}});Upfront.Application.LayoutEditor.add_object("Image",{Model:t,View:n,Element:r,Settings:i}),Upfront.Models.ImageModel=t,Upfront.Views.ImageView=n})})(jQuery);