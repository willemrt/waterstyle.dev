define(["scripts/upfront/settings/modules/base-module"],function(e){var t=Upfront.Settings.l10n.preset_manager,n=e.extend({className:"settings_module colors_settings_item clearfix",group:!0,get_title:function(){return this.options.title},initialize:function(e){this.options=e||{},this.fieldCounter=0;var n=this,r=this.options.state,i="single",s="no-toggle",o=[];this.options.toggle===!0&&this.fieldCounter++,this.options.single!==!0&&(i="two"),_.each(this.options.abccolors,function(e){n.options.toggle===!0&&(s="element-toggled");var t=new Upfront.Views.Editor.Field.Color({className:r+"-color-field upfront-field-wrap-color color-module module-color-field "+s+" "+i,blank_alpha:0,model:n.model,name:e.name,default_value:n.model.get(e.name),label_style:"inline",label:e.label,spectrum:{preferredFormat:"hex",change:function(t){if(!t)return!1;var r=t.get_is_theme_color()!==!1?t.theme_color:t.toRgbString();n.model.set(e.name,r)},move:function(t){if(!t)return!1;var r=t.get_is_theme_color()!==!1?t.theme_color:t.toRgbString();n.model.set(e.name,r)}}});o.push(t)}),this.fields=_(o),this.options.toggle===!0&&(this.group=!1,this.fields.unshift(new Upfront.Views.Editor.Field.Checkboxes({model:this.model,className:"useColors checkbox-title",name:n.options.fields.use,label:"",multiple:!1,values:[{label:t.color,value:"yes",checked:this.model.get(n.options.fields.use)}],change:function(e){n.model.set(n.options.fields.use,e),n.reset_fields(e)},show:function(e,t){var n=t.closest(".state_modules");e=="yes"?n.find("."+r+"-color-field").show():n.find("."+r+"-color-field").hide()}})))},reset_fields:function(e){var t=this;typeof e!="undefined"&&e==="yes"&&(_.each(this.options.abccolors,function(e){var n=t.get_static_field_value(e,t.options.prepend);t.update_field(e,n),t.save_static_value(e,n),this.fieldCounter++}),this.$el.empty(),this.render())},save_static_value:function(e,t){this.model.set(e.name,t.color)},get_static_field_value:function(e,t){var n={},r="";return typeof this.options.prefix!="undefined"&&(r=this.options.prefix+"-"),n.color=this.model.get(this.clear_prepend(r+e.name,t))||"",n},clear_prepend:function(e,t){return e.replace(t,"")},update_field:function(e,t){this.fields._wrapped[this.fieldCounter].set_value(t.color),this.fields._wrapped[this.fieldCounter].update_input_border_color(t.color)},render:function(){var e=this;this.constructor.__super__.render.call(this),this.fields.each(function(t){if(typeof t.spectrumOptions!="undefined"){var n=e.model.get(t.name);t.set_value(n),t.update_input_border_color(Upfront.Util.colors.to_color_value(n))}})}});return n});