(function(e){define(["text!elements/upfront-slider/tpl/backend.html"],function(t){var n=Upfront.Settings.l10n.slider_element,r=Upfront.Views.Editor.Field.Field.extend({template:_.template(e(t).find("#slides-setting-tpl").html()),events:{"click .uslider-add":"addSlides","click .remove-slide":"onRemoveSlide"},initialize:function(){this.listenTo(this.model.slideCollection,"add remove sort reset",this.render)},onRemoveSlide:function(t){this.model.view.removeSlide(e(t.currentTarget).parent())},render:function(){var t=this;this.$el.html(this.template({slides:this.model.slideCollection,l10n:n})),this.$(".uslider-slides-setting").sortable({items:".uslider_content_imgslide",start:function(e,t){t.item.addClass("uslider-is-dragged")},stop:function(e,n){var r=n.item.attr("rel"),i=t.getSlidePosition(r),s=!1;i!=-1&&(s=t.model.slideCollection.get(r),t.model.slideCollection.remove(r,{silent:!0}),t.model.slideCollection.add(s,{at:i}))}}),setTimeout(function(){var t=e("#settings");t.height(t.find(".upfront-settings_panel:visible").outerHeight())},100)},addSlides:function(){this.model.trigger("addRequest")},getSlidePosition:function(t){var n=0,r=!1;return this.$("div.uslider_content_slide").each(function(s){e(this).attr("rel")==t&&(r=n),n++}),r!==!1?r:-1},get_name:function(){return"slides"},get_value:function(){return this.model.slideCollection.toJSON()}});return r})})(jQuery);