/* http://keith-wood.name/realPerson.html
   Real Person Form Submission for jQuery v2.0.1.
   Written by Keith Wood (kwood{at}iinet.com.au) June 2009.
   Available under the MIT (http://keith-wood.name/licence.html) license. 
   Please attribute the author if you use it. */

(function(e){function o(e){var t=5381;for(var n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t}var t="realperson",n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r=n+"0123456789",i=[["   *   ","  * *  ","  * *  "," *   * "," ***** ","*     *","*     *"],["****** ","*     *","*     *","****** ","*     *","*     *","****** "],[" ***** ","*     *","*      ","*      ","*      ","*     *"," ***** "],["****** ","*     *","*     *","*     *","*     *","*     *","****** "],["*******","*      ","*      ","****   ","*      ","*      ","*******"],["*******","*      ","*      ","****   ","*      ","*      ","*      "],[" ***** ","*     *","*      ","*      ","*   ***","*     *"," ***** "],["*     *","*     *","*     *","*******","*     *","*     *","*     *"],["*******","   *   ","   *   ","   *   ","   *   ","   *   ","*******"],["      *","      *","      *","      *","      *","*     *"," ***** "],["*     *","*   ** ","* **   ","**     ","* **   ","*   ** ","*     *"],["*      ","*      ","*      ","*      ","*      ","*      ","*******"],["*     *","**   **","* * * *","*  *  *","*     *","*     *","*     *"],["*     *","**    *","* *   *","*  *  *","*   * *","*    **","*     *"],[" ***** ","*     *","*     *","*     *","*     *","*     *"," ***** "],["****** ","*     *","*     *","****** ","*      ","*      ","*      "],[" ***** ","*     *","*     *","*     *","*   * *","*    * "," **** *"],["****** ","*     *","*     *","****** ","*   *  ","*    * ","*     *"],[" ***** ","*     *","*      "," ***** ","      *","*     *"," ***** "],["*******","   *   ","   *   ","   *   ","   *   ","   *   ","   *   "],["*     *","*     *","*     *","*     *","*     *","*     *"," ***** "],["*     *","*     *"," *   * "," *   * ","  * *  ","  * *  ","   *   "],["*     *","*     *","*     *","*  *  *","* * * *","**   **","*     *"],["*     *"," *   * ","  * *  ","   *   ","  * *  "," *   * ","*     *"],["*     *"," *   * ","  * *  ","   *   ","   *   ","   *   ","   *   "],["*******","     * ","    *  ","   *   ","  *    "," *     ","*******"],["  ***  "," *   * ","*   * *","*  *  *","* *   *"," *   * ","  ***  "],["   *   ","  **   "," * *   ","   *   ","   *   ","   *   ","*******"],[" ***** ","*     *","      *","     * ","   **  "," **    ","*******"],[" ***** ","*     *","      *","    ** ","      *","*     *"," ***** "],["    *  ","   **  ","  * *  "," *  *  ","*******","    *  ","    *  "],["*******","*      ","****** ","      *","      *","*     *"," ***** "],["  **** "," *     ","*      ","****** ","*     *","*     *"," ***** "],["*******","     * ","    *  ","   *   ","  *    "," *     ","*      "],[" ***** ","*     *","*     *"," ***** ","*     *","*     *"," ***** "],[" ***** ","*     *","*     *"," ******","      *","     * "," ****  "]];e.JQPlugin.createPlugin({name:t,alphabetic:n,alphanumeric:r,defaultDots:i,defaultOptions:{length:6,regenerate:"Click to change",hashName:"{n}Hash",dot:"*",dots:i,chars:n},_getters:["getHash"],_challengeClass:t+"-challenge",_disabledClass:t+"-disabled",_hashClass:t+"-hash",_regenerateClass:t+"-regen",_textClass:t+"-text",_optionsChanged:function(t,n,r){e.extend(n.options,r);var i="";for(var u=0;u<n.options.length;u++)i+=n.options.chars.charAt(Math.floor(Math.random()*n.options.chars.length));n.hash=o(i+s);var a=this;t.closest("form").off("."+n.name).on("submit."+n.name,function(){var r=n.options.hashName.replace(/\{n\}/,t.attr("name")),u=e(this);u.find('input[name="'+r+'"]').remove(),u.append('<input type="hidden" class="'+a._hashClass+'" name="'+r+'" value="'+o(i+s)+'">'),setTimeout(function(){u.find('input[name="'+r+'"]').remove()},0)}),t.prevAll("."+this._challengeClass+",."+this._hashClass).remove().end().before(this._generateHTML(n,i)).prevAll("div."+this._challengeClass).click(function(){e(this).hasClass(a._disabledClass)||t.realperson("option",{})})},enable:function(t){t=e(t);if(!t.hasClass(this._getMarker()))return;t.removeClass(this._disabledClass).prop("disabled",!1).prevAll("."+this._challengeClass).removeClass(this._disabledClass)},disable:function(t){t=e(t);if(!t.hasClass(this._getMarker()))return;t.addClass(this._disabledClass).prop("disabled",!0).prevAll("."+this._challengeClass).addClass(this._disabledClass)},getHash:function(e){var t=this._getInst(e);return t?t.hash:0},_generateHTML:function(e,t){var n='<div class="'+this._challengeClass+'">'+'<div class="'+this._textClass+'">';for(var r=0;r<e.options.dots[0].length;r++){for(var i=0;i<t.length;i++)n+=e.options.dots[e.options.chars.indexOf(t.charAt(i))][r].replace(/ /g,"&#160;").replace(/\*/g,e.options.dot)+"&#160;&#160;";n+="<br>"}return n+='</div><div class="'+this._regenerateClass+'">'+e.options.regenerate+"</div></div>",n},_preDestroy:function(e,t){e.closest("form").off("."+t.name),e.prevAll("."+this._challengeClass+",."+this._hashClass).remove()}});var s=e.salt||"#salt";delete e.salt,e(function(){var t=e(s);t.length&&(s=t.text(),t.remove()),s==="#salt"&&(s="")})})(jQuery);